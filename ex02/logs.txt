/spark/bin/spark-submit \
>   --master spark://spark-master:7077 \
>   --packages \
> org.apache.hadoop:hadoop-aws:3.2.2,\
> org.postgresql:postgresql:42.2.23,\
> com.google.guava:guava:23.0,\
> org.apache.spark:spark-sql-kafka-0-10_2.12:3.3.0,\
> org.apache.kafka:kafka-clients:3.2.0,\
> net.snowflake:spark-snowflake_2.12:2.13.0-spark_3.3,\
> net.snowflake:snowflake-jdbc:3.13.23 \
>   --conf spark.executor.extraClassPath=/spark/jars/* \
>   --conf spark.driver.extraClassPath=/spark/jars/* \
>   /app/etl_job.py
:: loading settings :: url = jar:file:/spark/jars/ivy-2.5.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /root/.ivy2/cache
The jars for the packages stored in: /root/.ivy2/jars
org.apache.hadoop#hadoop-aws added as a dependency
org.postgresql#postgresql added as a dependency
com.google.guava#guava added as a dependency
org.apache.spark#spark-sql-kafka-0-10_2.12 added as a dependency
org.apache.kafka#kafka-clients added as a dependency
net.snowflake#spark-snowflake_2.12 added as a dependency
net.snowflake#snowflake-jdbc added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-ab888077-fa73-4c08-a37b-f18371177073;1.0
        confs: [default]
        found org.apache.hadoop#hadoop-aws;3.2.2 in central
        found com.amazonaws#aws-java-sdk-bundle;1.11.563 in central
        found org.postgresql#postgresql;42.2.23 in central
        found org.checkerframework#checker-qual;3.5.0 in central
        found com.google.guava#guava;23.0 in central
        found com.google.code.findbugs#jsr305;1.3.9 in central
        found com.google.errorprone#error_prone_annotations;2.0.18 in central
        found com.google.j2objc#j2objc-annotations;1.1 in central
        found org.codehaus.mojo#animal-sniffer-annotations;1.14 in central
        found org.apache.spark#spark-sql-kafka-0-10_2.12;3.3.0 in central
        found org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.3.0 in central
        found org.apache.hadoop#hadoop-client-runtime;3.3.2 in central
        found org.spark-project.spark#unused;1.0.0 in central
        found org.apache.hadoop#hadoop-client-api;3.3.2 in central
        found org.xerial.snappy#snappy-java;1.1.8.4 in central
        found org.slf4j#slf4j-api;1.7.32 in central
        found commons-logging#commons-logging;1.1.3 in central
        found com.google.code.findbugs#jsr305;3.0.0 in central
        found org.apache.commons#commons-pool2;2.11.1 in central
        found org.apache.kafka#kafka-clients;3.2.0 in central
        found com.github.luben#zstd-jni;1.5.2-1 in central
        found org.lz4#lz4-java;1.8.0 in central
        found org.slf4j#slf4j-api;1.7.36 in central
        found net.snowflake#spark-snowflake_2.12;2.13.0-spark_3.3 in central
        found net.snowflake#snowflake-ingest-sdk;0.10.8 in central
        found net.snowflake#snowflake-jdbc;3.13.30 in central
downloading https://repo1.maven.org/maven2/net/snowflake/spark-snowflake_2.12/2.13.0-spark_3.3/spark-snowflake_2.12-2.13.0-spark_3.3.jar ...
        [SUCCESSFUL ] net.snowflake#spark-snowflake_2.12;2.13.0-spark_3.3!spark-snowflake_2.12.jar (953ms)
downloading https://repo1.maven.org/maven2/net/snowflake/snowflake-ingest-sdk/0.10.8/snowflake-ingest-sdk-0.10.8.jar ...
        [SUCCESSFUL ] net.snowflake#snowflake-ingest-sdk;0.10.8!snowflake-ingest-sdk.jar (4763ms)
downloading https://repo1.maven.org/maven2/net/snowflake/snowflake-jdbc/3.13.30/snowflake-jdbc-3.13.30.jar ...
        [SUCCESSFUL ] net.snowflake#snowflake-jdbc;3.13.30!snowflake-jdbc.jar (20142ms)
:: resolution report :: resolve 2833ms :: artifacts dl 25921ms
        :: modules in use:
        com.amazonaws#aws-java-sdk-bundle;1.11.563 from central in [default]
        com.github.luben#zstd-jni;1.5.2-1 from central in [default]
        com.google.code.findbugs#jsr305;3.0.0 from central in [default]
        com.google.errorprone#error_prone_annotations;2.0.18 from central in [default]
        com.google.guava#guava;23.0 from central in [default]
        com.google.j2objc#j2objc-annotations;1.1 from central in [default]
        commons-logging#commons-logging;1.1.3 from central in [default]
        net.snowflake#snowflake-ingest-sdk;0.10.8 from central in [default]
        net.snowflake#snowflake-jdbc;3.13.30 from central in [default]
        net.snowflake#spark-snowflake_2.12;2.13.0-spark_3.3 from central in [default]
        org.apache.commons#commons-pool2;2.11.1 from central in [default]
        org.apache.hadoop#hadoop-aws;3.2.2 from central in [default]
        org.apache.hadoop#hadoop-client-api;3.3.2 from central in [default]
        org.apache.hadoop#hadoop-client-runtime;3.3.2 from central in [default]
        org.apache.kafka#kafka-clients;3.2.0 from central in [default]
        org.apache.spark#spark-sql-kafka-0-10_2.12;3.3.0 from central in [default]
        org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.3.0 from central in [default]
        org.checkerframework#checker-qual;3.5.0 from central in [default]
        org.codehaus.mojo#animal-sniffer-annotations;1.14 from central in [default]
        org.lz4#lz4-java;1.8.0 from central in [default]
        org.postgresql#postgresql;42.2.23 from central in [default]
        org.slf4j#slf4j-api;1.7.36 from central in [default]
        org.spark-project.spark#unused;1.0.0 from central in [default]
        org.xerial.snappy#snappy-java;1.1.8.4 from central in [default]
        :: evicted modules:
        com.google.code.findbugs#jsr305;1.3.9 by [com.google.code.findbugs#jsr305;3.0.0] in [default]
        org.apache.kafka#kafka-clients;2.8.1 by [org.apache.kafka#kafka-clients;3.2.0] in [default]
        org.slf4j#slf4j-api;1.7.32 by [org.slf4j#slf4j-api;1.7.36] in [default]
        net.snowflake#snowflake-jdbc;3.13.23 by [net.snowflake#snowflake-jdbc;3.13.30] in [default]
        ---------------------------------------------------------------------
        |                  |            modules            ||   artifacts   |
        |       conf       | number| search|dwnlded|evicted|| number|dwnlded|
        ---------------------------------------------------------------------
        |      default     |   28  |   3   |   3   |   4   ||   24  |   3   |
        ---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-ab888077-fa73-4c08-a37b-f18371177073
        confs: [default]
        24 artifacts copied, 0 already retrieved (234966kB/304ms)
26/01/17 00:39:27 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Traceback (most recent call last):
  File "/app/etl_job.py", line 6, in <module>
    from dotenv import load_dotenv
ModuleNotFoundError: No module named 'dotenv'
26/01/17 00:39:27 INFO ShutdownHookManager: Shutdown hook called
26/01/17 00:39:27 INFO ShutdownHookManager: Deleting directory /tmp/spark-928e39d5-2ebb-43a7-81c1-1a8ea7f388ff
